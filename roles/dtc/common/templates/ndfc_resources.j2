---
# This NDFC policy and switch attachments config data structure is auto-generated
# DO NOT EDIT MANUALLY
#

{# API
/appcenter/cisco/ndfc/api/v1/lan-fabric/rest/resource-manager/fabrics/<fabric>


    {
        "id": 967,
        "resourcePool": {
            "id": 0,
            "poolName": "LOOPBACK0_IP_POOL",
            "fabricName": "nac-ndfc2",
            "vrfName": "default",
            "poolType": "IP_POOL",
            "dynamicSubnetRange": null,
            "targetSubnet": 0,
            "overlapAllowed": false,
            "hierarchicalKey": "nac-ndfc2"
        },
        "entityType": "DeviceInterface",
        "entityName": "9999BI7ZJG4~loopback0",
        "allocatedIp": "20.0.0.211",
        "allocatedOn": 1738688381018,
        "allocatedFlag": true,
        "allocatedScopeValue": "9999BI7ZJG4",
        "ipAddress": "10.229.42.211",
        "switchName": "netascode-bleaf21",
        "hierarchicalKey": "0"
    }, #}


{% set routing_lo_id = MD_Extended.vxlan.underlay.general.underlay_routing_loopback_id %}
{% set vtep_lo_id = MD_Extended.vxlan.underlay.general.underlay_vtep_loopback_id %}

{% for switch in myvxlan.topology.resource_manager.underlay_routing_loopback %}
- entity_name: "{{ MD_Extended.vxlan.topology.switch_resource[switch.switch_name].serial_number }}~loopback{{ routing_lo_id }}"
  pool_type: IP
  pool_name: "LOOPBACK{{ routing_lo_id }}_IP_POOL"
  scope_type: device_interface
  resource: "{{switch.ip}}"
  switch:
    - "{{ MD_Extended.vxlan.topology.switch_resource[switch.switch_name].management_ipv4_address }}"
{% endfor %}

{% for switch in myvxlan.topology.resource_manager.underlay_vtep_loopback %}
- entity_name: "{{ MD_Extended.vxlan.topology.switch_resource[switch.switch_name].serial_number }}~loopback{{ vtep_lo_id }}"
  pool_type: IP
  pool_name: "LOOPBACK{{ vtep_lo_id }}_IP_POOL"
  scope_type: device_interface
  resource: "{{switch.ip}}"
  switch:
    - "{{ MD_Extended.vxlan.topology.switch_resource[switch.switch_name].management_ipv4_address }}"
{% endfor %}

{% for switch in myvxlan.topology.resource_manager.fabric_links %}
- entity_name: "{{ MD_Extended.vxlan.topology.switch_resource[switch.source_device].serial_number }}~{{ switch.source_interface }}~{{ MD_Extended.vxlan.topology.switch_resource[switch.dest_device].serial_number }}~{{ switch.dest_interface }}"
  pool_type: SUBNET
  pool_name: "SUBNET"
  scope_type: link
  resource: "{{ switch.subnet }}"
  switch:
    - "{{ MD_Extended.vxlan.topology.switch_resource[switch.switch_name].management_ipv4_address }}"
{% endfor %}